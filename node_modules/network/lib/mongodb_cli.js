const MongoClient = require('mongodb').MongoClient

class MongodbCli {

	constructor(name, cfg){
		this._name = name;
		this._cfg = cfg;
		let self = this
		MongoClient.connect(cfg.url, (err, db) => {
			if(err) return console.log(err);
			console.log(`mongodb ${name} connect success`);

			self.client = db.db(cfg.database)
		});
	}

	find(key, query, projection, callback){
		if(this.client == null) return callback("mogodb not connect success", null);

		if(query == null) query = {};
		if(projection == null) projection = {};
		this.client.collection(key).find(query).project(projection).toArray(callback)
	}
}

module.exports = MongodbCli;